{% extends "DotaStats/index.html" %}

{% block content %}
    <div id="content"></div>

    <script type="text/jsx">
        var Hero = React.createClass({
            render: function(){
                var hero = this.props.hero;
                return (
                    <div class="col-md-4">
                        <a href={hero.url}>
                            <img src={hero.hero_image} />
                            <div>{hero.localized_name}</div>
                        </a>
                    </div>
                )
            }
        });

        var HeroList = React.createClass({
            render: function() {
                var heroNodes = this.props.data.map(function (hero) {
                  return (
                    <Hero hero={hero}/>
                  );
                });
                return (
                  <div className="hero-list">
                    {heroNodes}
                  </div>
                );
            }
        });
        var HeroBox = React.createClass({
          getInitialState: function() {
            return {data: []};
          },
          componentDidMount: function() {
            $.ajax({
              url: this.props.url,
              dataType: 'json',
              cache: false,
              success: function(data) {
                this.setState({data: data});
              }.bind(this),
              error: function(xhr, status, err) {
                console.error(this.props.url, status, err.toString());
              }.bind(this)
            });
          },
          render: function() {
            return (
              <div className="hero-box">
                <h1>Heroes</h1>
                <HeroList data={this.state.data} />
              </div>
            );
          }
        });


        React.render(
          <HeroBox url="{% url 'hero-list' %}" />,
          document.getElementById('content')
        );
    </script>
{% endblock %}